.evs-group {
    flex-shrink: 0;
    gap: 8px;
    margin-left: 10px;
}

.tile-party::before {
    content: '';
    position: absolute;
    left: 0;
    top: 15%;
    bottom: 15%;
    width: 4px;
    background: #ff4757;
    border-radius: 0 4px 4px 0;
    box-shadow: 2px 0 8px rgba(255, 71, 87, 0.4);
    opacity: 0.8;
}

/* =========================================
   Unit Header Strip (队伍状态条 - 改良版)
   ========================================= */
.team-header-dash {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    padding: 15px 5px 8px 5px;
    margin: -20px 0 10px 0;
    transform: skewX(var(--s-deg));
    border-bottom: 2px dashed rgba(178, 190, 195, 0.3);
}

.th-title {
    font-family: var(--font-ui);
    font-weight: 900;
    font-size: 1.1rem;
    font-style: italic;
    color: #c8d0d8;
    letter-spacing: 0.5px;
    transform: skewX(var(--ns-deg));
    line-height: 1;
    position: relative;
    padding-left: 12px;
}

.th-title::before {
    content: '';
    position: absolute;
    left: 0;
    bottom: 8px;
    width: 6px;
    height: 6px;
    background: #ffb3b0;
    box-shadow: 2px 2px 0 rgba(0,0,0,0.1);
    transform: skewX(-6deg);
}

.th-status-grp {
    display: flex;
    align-items: center;
    gap: 15px;
    transform: skewX(var(--ns-deg));
}

.th-count {
    font-family: var(--font-ui);
    font-weight: 800;
    font-size: 1.2rem;
    color: #2d3436;
    line-height: 0.9;
}
.th-count small {
    color: #b2bec3;
    font-size: 0.95rem;
    font-weight: 600;
    margin-left: 1px;
}

.th-slots-viz {
    display: flex;
    gap: 3px;
    align-items: center;
    height: 100%;
}

.th-dot {
    width: 8px;
    height: 14px;
    background: #dfe4ea;
    transform: skewX(-15deg);
    border-radius: 2px;
    transition: all 0.3s;
}
.th-dot.active {
    background: #7db8ff;
    height: 18px;
}

/* =========================================
   Gender Indicators (性别符号)
   ========================================= */
.gender-mark {
    display: inline-block;
    vertical-align: middle;
    margin-left: 6px;
    font-size: 0.9em;
    font-weight: 700;
    letter-spacing: -0.5px;
    font-family: ui-sans-serif, system-ui, sans-serif;
    opacity: 1;
}
.gender-mark.male {
    color: #8ecbff;
    text-shadow: 0 0 2px rgba(142, 203, 255, 0.45);
}
.gender-mark.female {
    color: #ff9eb1;
    text-shadow: 0 0 2px rgba(255, 158, 177, 0.45);
}
.gender-mark.neutral {
    color: #b2bec3;
    opacity: 0.7;
}
.shiny-mark {
    display: inline-flex;
    align-items: center;
    margin-left: 6px;
    font-size: 0.9rem;
    color: #ffd86b;
    text-shadow: 0 0 4px rgba(255, 216, 107, 0.5);
}
/* =========================================
   全局基础 (Global)
   ========================================= */
:root {
    --s-deg: -10deg;
    --ns-deg: 10deg;
    
    --r-frame: 24px;
    --r-item: 8px;

    /* 基础调色 */
    --c-bg: #f2f4f8; --c-frame: #ffffff;
    --c-text: #2d3436; --c-gray: #b2bec3;
    --c-pink: #ff6b81; --c-blue: #70a1ff;

    --font-ui: 'Exo 2', 'Noto Sans SC', sans-serif;
    --font-txt: 'M PLUS Rounded 1c', sans-serif;
}

body { 
    margin: 0; padding: 0; 
    background: transparent;  /* 关键：确保不和酒馆UI撞色 */
    width: 100vw; height: 100vh;
    overflow: hidden; 
    font-family: var(--font-txt); color: var(--c-text); 
    background-color: #333; /* 开发用深底 */
}

/* =========================================
   1. 外部框架 (Frame) 【重点修复】
   ========================================= */
.ver-dawn-frame {
    position: relative; 
    margin: 0 auto;
    
    /* [Core Fix] 确容器拥有固定比例，不再忽大忽小 */
    width: 100%; 
    height: 100%; 
    max-width: 480px; 
    
    /* 解决内部被挤压崩溃的问题：使用 Flex 列布局 */
    display: flex; 
    flex-direction: column;
    
    /* 容器是垂直回正的矩形 */
    background-color: var(--c-bg);
    border-radius: var(--r-frame);
    box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.2), 0 20px 50px rgba(0, 0, 0, 0.5);
    
    /* [Key Fix] 之前设置 hidden 导致把斜着飞出去的尖角切了
       应该在这里允许一点溢出，或者必须在子容器加Padding 
       如果您是在 Webview 使用，建议保持 overflow: hidden 以维持圆角；
       所以修复点在下面的 .main-viewport */
    overflow: hidden;
}


/* 导航栏 - Dashboard模式下隐藏 */
.nav-wrap {
    flex-shrink: 0; /* 禁止被挤压 */
    background: var(--c-frame); padding: 0 16px 15px 16px;
    margin-bottom: 5px; display: none; gap: 8px; position:relative; z-index:15;
    box-shadow: 0 10px 20px -10px rgba(0,0,0,0.05);
}
.tab {
    flex: 1; height: 36px; cursor: pointer;
    transform: skewX(var(--s-deg)); 
    border: 2px solid #ebedf0; border-radius: 6px; background: #fff;
    display: flex; align-items: center; justify-content: center;
    transition: 0.2s;
    min-width: 0; /* 允许收缩 */
}
.t-txt { 
    transform: skewX(var(--ns-deg)); 
    font-family: var(--font-ui); 
    font-weight: 800; 
    color: #b2bec3; 
    font-size: 0.65rem;
    letter-spacing: 0.5px;
}
.tab.active { background: var(--c-text); border-color: var(--c-text); color: #fff; box-shadow: 3px 3px 0 rgba(70,70,70,0.1); }
.tab.active .t-txt { color: #fff; }
.tab[data-t="soc"].active { background: var(--c-pink); border-color: var(--c-pink); }
.tab[data-t="box"].active { background: #00b894; border-color: #00b894; border-width: 1px; }

/* =========================================
   2. 主视口 (Viewport) 【崩坏修复点】
   ========================================= */
.main-viewport {
    /* 使用 flex: 1 自动填满剩下全部高度 */
    flex: 1; 
    width: 100%; 
    position: relative; 
    background: transparent;
    
    /* 
       [CRITICAL FIX 3.0] 
       1. 内边距 padding-left/right: 25px -> 保证斜切的卡片左右都不会贴边被切
       2. padding-top: 15px -> 给上方卡片悬停上浮留出空间
       3. padding-bottom -> 留白底部 
    */
    padding: 15px 25px 40px 25px; 
    
    /* 确保 Padding 挤压的是内容，而不是增加宽度 */
    box-sizing: border-box;
    
    /* 仅允许纵向滚动 (Scroll) */
    overflow-y: auto; 
    /* 横向必须 Hidden 防止出现横条 */
    overflow-x: hidden;
    
    /* 提升层级，防止被 nav 阴影遮挡 */
    z-index: 10;
    
    /* 滚动条隐藏Hack */
    -ms-overflow-style: none; scrollbar-width: none;
}
.main-viewport::-webkit-scrollbar { display: none; }

/* 页面切换动画 */
.page { 
    display: none !important; 
    flex-direction: column; 
    gap: 15px; 
    width: 100%; 
    min-height: 100%; 
    position: relative; /* 确保返回按钮定位正确 */
}
.page.curr { 
    display: grid !important; 
    grid-template-columns: 1fr; 
    gap: 15px; 
    animation: fadeUp 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); 
}
@keyframes fadeUp { from {opacity:0; transform:translateY(15px);} to {opacity:1; transform:translateY(0);} }

/* =========================================
   3. 卡片 (Content Card)
   ========================================= */
.dash-card-box {
    width: 100%;
    height: 100px;
    background: white;
    transform: skewX(var(--s-deg));
    box-sizing: border-box;
    border-radius: var(--r-item);
    box-shadow: 4px 4px 0 #ebedf0;
    border: 1px solid #ebedf0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    margin: 0;
}

/* 交互悬浮 (恢复上浮) */
.dash-card-box:hover {
    transform: skewX(var(--s-deg)) translateY(-4px);
    box-shadow: 6px 8px 0 #d1d8e0;
    border-color: var(--c-blue);
    z-index: 10;
}

.dcb-inner {
    width: 100%;
    transform: skewX(var(--ns-deg));
    display: flex;
    flex-direction: column;
    align-items: center;
}

.ph-lbl { font-family: var(--font-ui); font-weight: 800; color: #dfe6e9; font-size: 2rem; user-select: none; }
.ph-sub { font-size: 0.6rem; font-weight: 700; color: #b2bec3; letter-spacing: 1px; margin-top: -5px; user-select: none; }

.section-label { font-size: 0.65rem; color: #b2bec3; font-weight: 800; margin: 0 0 2px 20px; letter-spacing: 1px; }
.dash-card-box.npc:hover { border-color: var(--c-pink); box-shadow: 6px 8px 0 rgba(253, 121, 168, 0.3); }

/* =================================
   Ver. Dawn - 宝可梦数据卡 (Style R)
   ================================= */

.dash-card-box {
    height: auto;
    min-height: 90px;
    align-items: stretch;
    padding: 0;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    background: #fff;
    overflow: hidden;
}

.dcb-inner {
    width: 100%;
    height: 100%;
    transform: skewX(var(--ns-deg));
    display: flex;
    flex-direction: column;
    position: relative;
    z-index: 1;
}
.dcb-inner::before {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    right: -20px;
    width: 140px;
    background: linear-gradient(90deg, transparent 0%, rgba(20,20,30,0.03) 1%, #f7f9fb 1%);
    transform: skewX(-20deg);
    z-index: -1;
    pointer-events: none;
    border-left: 2px solid rgba(255,255,255,0.8);
}

.pkm-summary {
    height: 90px;
    width: 100%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 10px 0 25px;
    box-sizing: border-box;
    background: transparent;
    cursor: pointer;
}

.pkm-summary::before {
    content: attr(data-slot);
    position: absolute;
    right: 25px;
    bottom: -18px;
    font-size: 5rem; font-weight: 900;
    font-family: var(--font-ui); font-style: italic;
    color: #eff2f5;
    pointer-events: none;
    z-index: -1;
}

.p-visual-grp {
    position: relative; z-index: 2;
    display: flex; align-items: center; gap: 15px;
}

.p-avatar {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 84px;
    height: 84px;
    transform: translateY(-14px);
}

.p-avatar img {
    width: 84px;
    height: 84px;
    object-fit: contain;
    filter: drop-shadow(4px 6px 0 rgba(223, 230, 233, 0.5));
    transition: 0.2s cubic-bezier(0.18, 0.89, 0.32, 1.28);
}
.p-avatar img.pixel-fallback {
    filter: none;
    image-rendering: pixelated;
    opacity: 0.85;
    width: 64px;
    height: 64px;
    margin-top: 36px;
}
.p-avatar img.regional-sprite {
    transform: translateY(20px);
}
.dash-card-box:hover .p-avatar img { transform: scale(1.1) rotate(5deg); }
.dash-card-box:hover .p-avatar img.regional-sprite { transform: translateY(20px) scale(1.1) rotate(5deg); }

.p-texts {
    display: flex; flex-direction: column;
    line-height: 1; transform: translateY(2px);
}

.p-meta-line {
    display: flex; align-items: baseline; gap: 6px;
    font-family: var(--font-ui);
    color: #b2bec3; font-weight: 800; font-size: 0.75rem; letter-spacing: 1px;
}
.p-lv-val { color: var(--c-text); font-size: 0.9rem; }

.p-name {
    font-size: 1.6rem; font-weight: 900; color: #2d3436;
    letter-spacing: -1px; margin-top: 2px;
    text-transform: uppercase;
    background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.summary-actions {
    margin-left: auto;
    display: flex;
    align-items: center;
    height: 100%;
    gap: 4px;
    position: relative;
}

.expand-action {
    display: flex; align-items: center; justify-content: center;
    width: 40px; height: 100%;
    margin-right: -10px;
    color: #e2e6ea;
    transition: all 0.3s;
    z-index: 2;
}
.expand-action svg { 
    stroke-width: 4; 
    width: 18px; 
    filter: drop-shadow(1px 1px 0 #fff);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.dash-card-box.open .expand-action svg {
    transform: rotate(180deg);
}

.pkm-details {
    display: grid !important;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    width: 90%;
    position: relative;
    z-index: 2;
    background: transparent;
}

.dash-card-box.open .pkm-details {
    grid-template-rows: 1fr;
    background-image: linear-gradient(90deg, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.05) 100%, transparent 100%);
    background-size: 100% 1px;
    background-repeat: no-repeat;
    background-position: top left;
}

.details-overflow {
    overflow: hidden;
    position: relative;
    display: flex;
    flex-direction: column;
}

/* ========================================================
   Ver. Dawn - HUD System [Refined]
   ======================================================== */
.detail-padder.tech-mode {
    padding: 0 16px 20px 16px !important;
    display: flex;
    flex-direction: column;
    width: 100%;
    min-height: 280px;
    box-sizing: border-box;
    cursor: default;
    transform: translateY(-15px);
    opacity: 0;
    transition: all 0.3s ease;
}
.dash-card-box.open .detail-padder.tech-mode {
    transform: translateY(0);
    opacity: 1;
    transition-delay: 0.1s;
}

.top-rail {
    display: flex;
    align-items: center;
    height: 36px;
    gap: 10px;
    margin-bottom: 20px;
    position: relative;
    border-bottom: none;
}
.element-grp {
    display: flex;
    gap: 4px;
    margin-right: auto;
}
.type-mini {
    transform: skewX(-15deg);
    padding: 2px 12px;
    border-radius: 2px;
    font-size: 0.7rem;
    font-weight: 900;
    color: #fff;
    font-family: var(--font-ui);
    text-transform: uppercase;
    box-shadow: 2px 3px 6px rgba(0,0,0,0.15);
    line-height: 1.4;
}
.type-mini span {
    display: block;
    transform: skewX(15deg);
}

.meta-chips {
    display: flex;
    gap: 6px;
    align-items: center;
}
.m-tag {
    transform: skewX(-15deg);
    padding: 3px 12px;
    border-radius: 2px;
    font-size: 0.65rem;
    font-weight: 900;
    font-family: var(--font-ui);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.05);
    display: flex;
    align-items: center;
    justify-content: center;
}
.m-tag span {
    transform: skewX(15deg);
}
.m-tag.nature {
    background: #fff;
    box-shadow: 2px 2px 0 var(--prim-color);
    border: 1px solid #f1f2f6;
    color: var(--prim-color);
}
.m-tag.ability {
    background: #e1e7ec;
    color: #2d3436;
    box-shadow: 2px 2px 0 #cfd6db;
}

.item-box {
    width: 32px;
    height: 32px;
    flex-shrink: 0;
    background: #f1f2f6;
    box-shadow: inset 0 0 0 1px #fff, 2px 2px 0 #d1d8e0;
    border-radius: 4px;
    transform: skewX(-15deg);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: transform 0.2s;
    overflow: hidden;
}
.item-box img {
    width: 24px;
    height: 24px;
    object-fit: contain;
    transform: skewX(15deg);
    image-rendering: -webkit-optimize-contrast;
}
.item-box:hover {
    transform: skewX(-15deg) translateY(-2px);
    z-index: 10;
    background: #fff;
}
.item-box:hover::after {
    content: attr(data-name);
    position: absolute;
    bottom: -28px;
    right: -5px;
    background: #2d3436;
    color: #fff;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.6rem;
    font-weight: 700;
    white-space: nowrap;
    z-index: 20;
    transform: skewX(15deg);
    pointer-events: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.kinetic-moves {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    gap: 10px;
    margin: 15px 0;
    width: 100%;
    min-width: 100%;
    height: 120px;
    box-sizing: border-box;
}
.k-move-shell {
    position: relative;
    transform: skewX(-15deg);
    border-radius: 3px;
    background: #2d3436;
    border-left: 8px solid var(--bar-c, var(--prim-color, #ff6b6b));
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 3px 3px 0 rgba(70,70,70,0.15);
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    padding: 6px 10px;
    min-height: 36px;
    width: 100%;
    box-sizing: border-box;
}
.k-move-shell span {
    transform: skewX(15deg);
    color: #fff;
    font-family: var(--font-txt);
    font-weight: 900;
    font-size: 0.85rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-shadow: 0 2px 0 rgba(0,0,0,0.2);
    width: 100%;
    padding: 0 5px;
    text-align: center;
}
.k-move-shell.empty {
    background: transparent;
    border: 2px dashed rgba(255,255,255,0.2);
    border-left: 8px solid rgba(255,255,255,0.15);
    box-shadow: none;
}
.k-move-shell.empty span {
    color: rgba(255,255,255,0.3);
}
.k-move-shell:hover {
    background: var(--prim-color, #ff6b6b);
    transform: skewX(-15deg) scale(1.05) translateY(-3px);
    z-index: 10;
    box-shadow: 6px 8px 12px rgba(0,0,0,0.2);
}

.bot-stat-strip {
    margin-top: auto;
    background: #f1f3f5;
    border: 1px solid #ebedf0;
    padding: 6px 10px;
    margin-bottom: 2px;
    transform: skewX(-15deg);
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    box-shadow: inset 0 1px 0 #fff;
    width: 100%;
    box-sizing: border-box;
}
.ivs-group,
.evs-group {
    transform: skewX(15deg);
    display: flex;
    align-items: center;
    gap: 8px;
}
.ivs-group {
    flex: 1;
    white-space: nowrap;
}
.micro-lbl {
    font-size: 0.55rem;
    font-weight: 800;
    color: #b2bec3;
    font-family: var(--font-ui);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 1px;
}
.hex-chips {
    display: inline-flex;
    gap: 3px;
}
.chip-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 24px;
    background: #fff;
    border-radius: 3px;
    border: 1px solid #dfe4ea;
    font-family: var(--font-ui);
    font-size: 0.7rem;
    font-weight: 700;
    color: #636e72;
    line-height: 0.9;
    position: relative;
    cursor: default;
    transition: 0.2s;
}
.chip-cell::before {
    content: attr(data-stat);
    font-size: 0.45rem;
    font-weight: 900;
    color: #b2bec3;
    margin-bottom: 1px;
}
.chip-cell.max {
    border-color: rgba(0,0,0,0.1);
    color: var(--prim-color, #2d3436);
    background: #fff;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
.chip-cell.max::before {
    color: var(--prim-color, #b2bec3);
    opacity: 0.6;
}
.chip-cell:hover {
    transform: translateY(-2px);
    border-color: var(--prim-color, #2d3436);
    z-index: 5;
}
.evs-group .evs-val {
    font-family: var(--font-txt);
    font-size: 0.85rem;
    font-weight: 900;
    color: var(--sec-color, #70a1ff);
    letter-spacing: -0.5px;
    background: #fff;
    padding: 0 6px;
    border-radius: 3px;
    border: 1px solid #ebedf0;
}

/* =========================================
   Empty Slot Styling (Ultra Flat & Light)
   极致轻量化：无内衬线、浅灰字、极淡背景
   ========================================= */

.dash-card-box.empty {
    position: relative;
    border: 2px dashed #dcdde1; 
    background-color: rgba(245, 246, 250, 0.4); 
    background-image: none !important; 
    box-shadow: none !important;
    opacity: 1; 
    cursor: pointer;
    overflow: hidden;
    transition: all 0.2s ease-out;
}

.dash-card-box.empty::before,
.dash-card-box.empty::after,
.dash-card-box.empty .dcb-inner::before,
.dash-card-box.empty .dcb-inner::after {
    display: none !important;
    content: none !important;
    border: none !important;
    background: none !important;
}

.dash-card-box.empty .dcb-inner {
    height: 100%;
    display: flex;
    justify-content: center; 
    align-items: center;  
    z-index: 2;
}

.empty-placeholder {
    background: transparent;
    border: none;
    padding: 0;
    font-family: var(--font-ui);
    font-weight: 800;         
    font-size: 1.4rem;        
    color: #dfe4ea;           
    letter-spacing: 1px;
    text-transform: uppercase;
    transform: skewX(15deg);  
    text-shadow: none; 
    font-style: italic;
    opacity: 1;
    transition: color 0.2s;
}
.nb-icon-img {
    width: 22px;
    height: 22px;
    object-fit: contain;
    image-rendering: pixelated;
    image-rendering: -webkit-optimize-contrast;
    filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
}

.dash-card-box.empty:hover {
    border-color: #a4b0be; 
    background-color: #fff;
    border-style: dashed;
    transform: skewX(var(--s-deg)); 
    box-shadow: none; 
}

.dash-card-box.empty:hover .empty-placeholder {
    color: #a4b0be;
}

/* =========================================
   4. 战术弹药 (Mech Bar) [悬浮修正版]
   ========================================= */
.mech-wrapper { 
    position: relative;
    display: flex; 
    align-items: center; 
    justify-content: flex-end;
    gap: 8px;
    height: 36px; 
}

.mech-btn {
    position: relative;
    z-index: 60;
    width: 20px;
    height: 32px;
    flex-shrink: 0;
    background: #dfe4ea;
    color: #636e72;
    border-radius: 4px; 
    border: none;
    transform: skewX(-15deg); cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: 0.2s ease;
    box-shadow: 1px 1px 0 rgba(0,0,0,0.1); 
}
.mech-btn:hover { background: #ced6e0; color: #2d3436; }
.mech-btn svg {
    width: 22px; height: 22px;
    transform: skewX(15deg) scale(1.8);
    transition: transform 0.3s;
    stroke-width: 4.5;
}
.mech-btn.open {
    background: transparent;
    color: #ff8fa1;
    border: 2px solid #ff8fa1;
    width: 24px;
    transform: skewX(-15deg) translateY(1px);
    box-shadow: none;
}
.mech-btn.open svg { transform: skewX(15deg) scale(1.8) rotate(180deg); }

.mech-matrix.icon-mode {
    position: absolute;
    right: 32px;
    top: 50%;
    transform: translate(0, -50%) skewX(-15deg);
    display: flex; 
    align-items: center; 
    flex-wrap: nowrap;
    padding: 0;
    gap: 2px;
    background: transparent;
    border-radius: 8px; 
    z-index: 55;
    transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    pointer-events: none;
}
.mech-matrix.icon-mode.expanded {
    pointer-events: auto;
}

.mech-matrix.icon-mode .cell {
    width: 8px;
    height: 32px;
    background: #e2e6ea; 
    border-radius: 2px;
    transform: skewX(0deg); 
    margin-right: 2px;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    color: transparent;
}
.mech-matrix.icon-mode .cell:not(.active):hover { cursor: default; }

.mech-matrix.icon-mode .cell.active {
    opacity: 1;
    background: var(--c-lite);
    box-shadow: inset 0 -4px 0 0 var(--bar-color);
}
.mech-matrix.icon-mode .cell svg {
    opacity: 0; 
    transform: skewX(15deg) scale(0.5);
    transition: opacity 0.2s, transform 0.3s;
}
.mech-matrix.icon-mode .cell[data-mech="mega"] svg,
.mech-matrix.icon-mode .cell[data-mech="style"] svg {
    transform: skewX(15deg) scale(0.5) translateY(2px);
}

.mech-matrix.icon-mode.expanded {
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255,255,255,0.6);
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    padding: 6px 10px;
    right: 32px;
    transform: translate(0, -50%) skewX(-15deg);
}

.mech-matrix.icon-mode.expanded .cell {
    width: 32px;
    border-radius: 6px; 
    background: transparent;
    opacity: 0.5;
    margin-right: 0;
    transform: none;
}
.mech-matrix.icon-mode.expanded .cell svg {
    opacity: 1;
    color: #b2bec3;
    transform: skewX(15deg) scale(1.0);
    transition-delay: 0.1s;
}
.mech-matrix.icon-mode.expanded .cell[data-mech="mega"] svg,
.mech-matrix.icon-mode.expanded .cell[data-mech="style"] svg {
    transform: skewX(15deg) scale(1.0) translateY(2px);
}
.mech-matrix.icon-mode.expanded .cell.active {
    background: transparent;
    box-shadow: none;
    opacity: 1;
}
.mech-matrix.icon-mode.expanded .cell.active svg { color: var(--bar-color); }
.mech-matrix.icon-mode.expanded .cell.active:hover { 
    transform: translateY(-3px);
    filter: brightness(1.05); 
}

.cell[data-mech="mega"]  { --bar-color: #6c5ce7; --c-lite: #efeafa; }
.cell[data-mech="z"]     { --bar-color: #f1c40f; --c-lite: #fcf6d6; }
.cell[data-mech="dmax"]  { --bar-color: #e84393; --c-lite: #fbebf4; }
.cell[data-mech="tera"]  { --bar-color: #00cec9; --c-lite: #dcfbfb; }
.cell[data-mech="bond"]  { --bar-color: #2ecc71; --c-lite: #e4fbf0; }
.cell[data-mech="style"] { --bar-color: #d63031; --c-lite: #fae3e3; }
.cell[data-mech="eye"]   { --bar-color: #636e72; --c-lite: #f1f2f6; }
.cell[data-mech="cap"]   { --bar-color: #e67e22; --c-lite: #fdebd0; }

/* =========================================
   AVS UI Upgrade (美化后的仪表板)
   ========================================= */
.avs-action {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 100%;
    margin-right: -2px;
    margin-top: -6px;
    color: #b2bec3;
    cursor: pointer;
    z-index: 35;
    transition: all 0.3s;
    align-self: flex-start;
}
.avs-action svg {
    width: 20px;
    fill: none;
    stroke: currentColor;
    stroke-width: 2;
    transition: all 0.3s cubic-bezier(0.34, 1.6, 0.64, 1);
    filter: drop-shadow(0 0 0 transparent);
}
.avs-action:hover {
    color: #ff6b81;
    transform: translateY(-2px);
}
.avs-action:hover svg {
    fill: rgba(255, 107, 129, 0.2);
}
.avs-action.active {
    color: #ff6b81;
}
.avs-action.active svg {
    fill: #ff6b81;
    transform: scale(1.15);
    filter: drop-shadow(0 2px 5px rgba(255,107,129,0.5));
}

.avs-dashboard {
    position: absolute;
    left: 85px;
    right: 50px;
    top: 50%;
    height: 52px;
    transform: translateY(-32%) translateX(-8px) skewX(var(--s-deg));
    transform-origin: center;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid #fff;
    border-bottom: 2px solid #ebedf0;
    border-radius: 4px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05), inset 0 1px 0 rgba(255,255,255,1);
    z-index: 20;
    display: flex;
    pointer-events: none;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.avs-dashboard.visible {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(-32%) translateX(-8px) skewX(var(--s-deg));
}
.avs-stat-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    transform: skewX(var(--ns-deg));
    border-right: 1px dashed rgba(0,0,0,0.1);
}
.avs-stat-item:last-child {
    border-right: none;
}
.avs-stat-item::before {
    content: '';
    position: absolute;
    top: -1px;
    left: 8px;
    right: 8px;
    height: 3px;
    background: currentColor;
    border-radius: 0 0 2px 2px;
    box-shadow: 0 1px 3px currentColor;
    opacity: 0.8;
}
.asi-label {
    font-size: 0.45rem;
    font-weight: 900;
    color: #b2bec3;
    letter-spacing: 0.5px;
    margin-bottom: 1px;
}
.asi-val {
    font-family: var(--font-ui);
    font-style: italic;
    font-weight: 800;
    font-size: 1.05rem;
    line-height: 0.9;
    color: #2d3436;
}
.asi-stat-trust    { color: #feca57; }
.asi-stat-passion  { color: #ff6b6b; }
.asi-stat-insight  { color: #54a0ff; }
.asi-stat-devotion { color: #a55eea; }
.asi-stat-trust .asi-val    { color: #f1c40f; }
.asi-stat-passion .asi-val  { color: #e55039; }
.asi-stat-insight .asi-val  { color: #4a90e2; }
.asi-stat-devotion .asi-val { color: #8e44ad; }

/* =========================================
   SOCIAL GRID SYSTEM (NPC 关系网)
   ========================================= */
#social-grid-view {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 12px;
    padding: 10px 0 50px 0;
}

.npc-card {
    position: relative;
    height: 180px;
    background: #fff;
    border-radius: 6px;
    overflow: hidden;
    cursor: pointer;
    border: 1px solid #ebedf0;
    border-bottom: 4px solid var(--r-color);
    box-shadow: 2px 2px 5px rgba(0,0,0,0.05);
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}
.npc-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 15px rgba(0,0,0,0.12);
    z-index: 5;
}

.npc-portrait {
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at center, #f5f6fa 0%, #dcdde1 100%);
    display: flex;
    align-items: flex-end;
    justify-content: center;
}
.npc-portrait img {
    height: 85%;
    width: auto;
    object-fit: contain;
    filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1));
    transition: transform 0.3s ease;
}
.npc-card:hover .npc-portrait img {
    transform: scale(1.08);
}

.npc-info-shade {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 68px;
    background: linear-gradient(180deg, transparent 0%, rgba(255,255,255,0.9) 45%, rgba(255,255,255,0.98) 100%);
    backdrop-filter: blur(3px);
    padding: 8px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    border-top: 1px solid rgba(255,255,255,0.6);
}

.n-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.n-name {
    font-family: var(--font-ui);
    font-weight: 800;
    font-size: 0.95rem;
    text-transform: uppercase;
    color: #2d3436;
}
.n-stage-icon {
    font-size: 0.85rem;
}

.n-bar-box {
    margin-top: 4px;
    width: 100%;
    position: relative;
}
.n-bar-label {
    display: flex;
    justify-content: space-between;
    font-size: 0.55rem;
    font-weight: 700;
    color: #636e72;
    text-transform: uppercase;
    letter-spacing: 0.6px;
}
.progress-track {
    width: 100%;
    height: 4px;
    border-radius: 2px;
    margin-top: 2px;
    background: #dfe6e9;
    overflow: hidden;
}
.progress-fill {
    height: 100%;
    border-radius: 2px;
    background: var(--r-color);
    transition: width 0.3s ease;
}

.npc-card[data-stage="-2"] .npc-portrait {
    filter: grayscale(100%) contrast(1.2);
    background: repeating-linear-gradient(45deg, #2d3436, #2d3436 10px, #353b48 10px, #353b48 20px);
}
.npc-card[data-stage="4"] .npc-info-shade {
    background: linear-gradient(180deg, transparent 0%, rgba(255,245,210,0.9) 60%, rgba(255,245,210,1) 100%);
}

/* =========================================
   NPC 特殊羁绊 Badge (右上角图标)
   ========================================= */
.npc-bond-badge {
    position: absolute;
    top: 6px;
    right: 6px;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 12;
    border-radius: 4px;
    font-size: 1.1rem;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
}
.npc-bond-badge .nb-bg {
    display: none;
}
.npc-bond-badge.locked {
    background: rgba(0,0,0,0.45);
    border: 1px solid rgba(255,255,255,0.35);
    border-radius: 50%;
    filter: grayscale(100%) opacity(0.75);
    color: #fff;
    transform: scale(0.9);
}
.npc-bond-badge.locked .nb-icon {
    opacity: 0.55;
    filter: blur(0.4px);
}
.npc-bond-badge.unlocked {
    background: rgba(255,255,255,0.2);
    backdrop-filter: blur(4px);
    border: 1px solid #fff;
    border-radius: 6px;
    box-shadow:
        0 2px 8px rgba(0,0,0,0.12),
        inset 0 0 10px rgba(255,255,255,0.35),
        0 0 10px rgba(255,223,0,0.35);
    animation: badgeFloat 3s ease-in-out infinite;
}
.npc-bond-badge.unlocked .nb-bg {
    display: block;
    position: absolute;
    inset: 0;
    z-index: -1;
    background: radial-gradient(circle, rgba(255,255,255,0.85) 0%, transparent 70%);
    opacity: 0.4;
}
.npc-bond-badge:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(255,255,255,0.5);
    background: #fff;
    color: #2d3436;
}
@keyframes badgeFloat {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-2px); }
}

/* =========================================
   [NEW] LEADER SYSTEM STYLES
   ========================================= */

.dash-card-box.is-leader {
    border-color: #f1c40f;
    box-shadow: 4px 4px 0 rgba(241, 196, 15, 0.3);
}
.dash-card-box.is-leader:hover {
    border-color: #f39c12;
    box-shadow: 6px 8px 0 rgba(243, 156, 18, 0.4);
}

.lead-tag {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 14px;
    padding: 0 4px;
    transform: skewX(-6deg);
    background: #f1c40f;
    border-radius: 2px;
    margin-left: 6px;
    box-shadow: 1px 1px 4px rgba(0,0,0,0.2);
}
.lead-text {
    transform: skewX(6deg);
    font-size: 0.6rem;
    font-weight: 900;
    color: #fff;
    line-height: 1;
    letter-spacing: 0.5px;
}

.leader-action {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 100%;
    margin-right: 0;
    color: #b2bec3;
    cursor: pointer;
    z-index: 36;
    transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.leader-action svg {
    width: 18px;
    fill: none;
    stroke: currentColor;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
    transition: inherit;
    transform: skewX(5deg);
}

.leader-action:not(.active):hover {
    color: #70a1ff;
    transform: scale(1.1);
}

.leader-action.active {
    color: #f1c40f;
    cursor: default;
    filter: drop-shadow(0 0 3px rgba(241, 196, 15, 0.5));
}
.leader-action.active svg {
    fill: #f1c40f;
    transform: skewX(0deg) scale(1.1) translateY(-1px);
}

/* =========================================
   Z-Index Layer Patch (图层与层级修正)
   确保展开的 AVS 仪表盘盖住下面的功能图标
   ========================================= */
.avs-dashboard {
    z-index: 40 !important;
}
.leader-action {
    z-index: 20;
    position: relative;
}
.avs-action {
    z-index: 60;
    position: relative;
}
.lead-tag {
    z-index: 25;
    position: relative;
}

/* =========================================
   SYS.CONFIG PAGE STYLES
   ========================================= */

/* 设置项卡片容器 */
.config-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* 单个设置条目：类似战术卡片的扁平化设计 */
.cfg-card {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 72px;
    background: #fff;
    border: 1px solid #ebedf0;
    border-radius: 6px; /* 使用稍小的圆角 */
    padding: 0 24px;
    transform: skewX(var(--s-deg)); /* 核心倾斜风格 */
    box-shadow: 2px 3px 0 rgba(0,0,0,0.03);
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    overflow: hidden;
}

/* 装饰左侧的色条 */
.cfg-card::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 6px;
    background: var(--cfg-color, #b2bec3);
    transition: background 0.3s;
}

.cfg-card:hover {
    transform: skewX(var(--s-deg)) translateX(4px);
    box-shadow: 4px 6px 12px rgba(0,0,0,0.08);
    border-color: var(--cfg-color, #c8d6e5);
}

/* 左侧文字信息 */
.cfg-info {
    display: flex;
    flex-direction: column;
    transform: skewX(var(--ns-deg)); /* 文字回正 */
    gap: 4px;
}
.cfg-label {
    font-family: var(--font-ui);
    font-weight: 800;
    font-size: 1.1rem;
    color: #2d3436;
    letter-spacing: -0.5px;
    text-transform: uppercase;
}
.cfg-desc {
    font-size: 0.7rem;
    font-weight: 600;
    color: #b2bec3;
    font-family: var(--font-txt);
}

/* 右侧自定义开关 (Mechanical Toggle) */
.tgl-track {
    width: 56px;
    height: 28px;
    background: #e2e6ea;
    border-radius: 2px;
    position: relative;
    cursor: pointer;
    transform: skewX(var(--ns-deg)); /* 回正，但也保持一定的硬朗感 */
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    transition: all 0.3s;
    border: 1px solid transparent;
}

/* 滑块按钮 */
.tgl-thumb {
    position: absolute;
    top: 2px; bottom: 2px;
    left: 2px; 
    width: 24px;
    background: #fff;
    box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
    border-radius: 1px;
    transition: all 0.3s cubic-bezier(0.5, 1.6, 0.4, 0.7);
    display: flex; 
    align-items: center; justify-content: center;
}
/* 滑块上的小装饰 */
.tgl-thumb::after {
    content: '';
    width: 4px; height: 12px;
    border-left: 2px solid #ebedf0;
    border-right: 2px solid #ebedf0;
}

/* 激活状态 */
.tgl-track.active {
    background: var(--cfg-color); /* 跟随主题色 */
    box-shadow: inset 0 2px 6px rgba(0,0,0,0.2);
}
.tgl-track.active .tgl-thumb {
    transform: translateX(26px); /* 移动滑块 */
    box-shadow: -1px 1px 3px rgba(0,0,0,0.2);
}
/* 用装饰线表示“通电”状态 */
.cfg-card.active::after {
    content: '';
    position: absolute;
    right: 15px; top: -10px; bottom: -10px;
    width: 80px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transform: rotate(20deg);
    opacity: 0;
    pointer-events: none;
    animation: sheen 3s infinite ease-in-out;
}
.cfg-card.active {
    background: linear-gradient(90deg, #fff 40%, rgba(255,255,255,0.5) 100%);
}

@keyframes sheen {
    0% { transform: translateX(-100px) skewX(-20deg); opacity: 0; }
    20% { opacity: 0.5; }
    100% { transform: translateX(200px) skewX(-20deg); opacity: 0; }
}

/* Config page layout adjustments */
#pg-settings .team-header-dash {
    margin-top: -25px;
    margin-bottom: 10px;
    position: relative;
    z-index: 5;
}

#pg-settings .config-grid {
    margin-top: -5px;
    gap: 15px;
}

/* =========================================
   修正补丁 Ver 2.0 (强制顶部对齐)
   解决内容过短时页面垂直被撑开的问题
   ========================================= */

/* 1. 强制页面只要是 Grid 模式，内容必须顶格排列，不允许垂直分散 */
.page.curr {
    align-content: start !important;
}

/* 2. 针对设置(Config)页面做特殊的大幅上移 */
#pg-settings,
#pg-settings.page.curr {
    grid-template-rows: max-content max-content;
    align-items: start !important;
    justify-items: stretch !important;
    margin-top: -8px !important;
}

#pg-settings .team-header-dash {
    margin-top: 12px !important;
    margin-bottom: 10px !important;
    padding-top: 0 !important;
}

#pg-settings .config-grid {
    margin-top: 0 !important;
}

/* 3. 头部层级补丁 */
.header-section {
    z-index: 50;
}

/* =========================================
   [ADDON] BOX SYSTEM (PC / Storage) v3.0 FIXED
   空间传输协议终端界面 - 修复布局与动效
   ========================================= */

/* 页面容器微调 */
#pg-box {
    padding-bottom: 90px; /* 给底部悬浮操作栏留出更多空间 */
    align-content: start;
}

/* 分区标题栏 */
.box-header-strip {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
    padding-left: 20px;
    border-left: 4px solid var(--accent-color, #a29bfe);
    transform: skewX(var(--s-deg));
}
.box-header-strip.storage-green {
    border-left-color: #00b894;
}
.box-header-title {
    font-family: var(--font-ui);
    font-weight: 800;
    font-size: 0.95rem;
    color: #636e72;
    transform: skewX(var(--ns-deg));
}
.box-header-meta {
    font-size: 0.7rem;
    color: #b2bec3;
    font-weight: 700;
    transform: skewX(var(--ns-deg));
}

/* =========================================
   [REMASTERED v3.1] CLOUD STORAGE & CELLS
   Tech-Green Grid + Dot Matrix Hover Effect
   ========================================= */

/* --- 1. UPPER AREA: 当前队伍 (Hand Party) --- */
.box-party-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; 
    gap: 10px;
    margin-bottom: 25px;
}

.box-char-card {
    position: relative;
    height: 56px;
    background: #f6fffc;
    border: 1px solid rgba(0, 184, 148, 0.25);
    border-radius: 6px;
    transform: skewX(var(--s-deg));
    box-shadow: 2px 2px 0 rgba(0,0,0,0.03);
    cursor: pointer;
    transition: all 0.2s ease-out;
    display: flex;
    align-items: center;
    padding: 0 10px;
    overflow: hidden;
}

.box-char-card:not(.empty):hover {
    transform: skewX(var(--s-deg)) translateY(-2px);
    box-shadow: 4px 4px 6px rgba(0,0,0,0.05);
    border-color: #55efc4;
    z-index: 5;
    background-image: radial-gradient(rgba(0, 184, 148, 0.25) 1px, transparent 1px);
    background-size: 7px 7px;
    background-position: center;
}

.box-char-card.selected {
    background: #eafff7;
    border: 1px solid #00b894 !important;
    box-shadow: 0 0 0 1px #00b894, 4px 4px 15px rgba(0, 184, 148, 0.2);
}
.box-char-card.selected::before {
    content: 'TARGET';
    position: absolute;
    right: 5px; bottom: -6px;
    font-family: var(--font-ui);
    font-size: 1.8rem;
    font-weight: 900;
    font-style: italic;
    color: rgba(0, 184, 148, 0.08);
    pointer-events: none;
    transform: skewX(var(--ns-deg));
}

.bcc-inner {
    width: 100%;
    transform: skewX(var(--ns-deg));
    display: flex;
    align-items: center;
    gap: 12px;
}

.bcc-icon {
    width: 52px; height: 52px;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
}
.bcc-icon img {
    width: 100%; height: 100%; object-fit: contain;
    filter: drop-shadow(1px 2px 2px rgba(0,0,0,0.1));
}
.bcc-icon img.regional-icon {
    width: 120%; height: 120%;
    transform: translateY(-8px);
}

.bcc-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    line-height: 1.1;
    overflow: hidden;
}
.bcc-name {
    font-size: 0.85rem;
    font-weight: 800;
    color: #2d3436;
    text-transform: uppercase;
    font-family: var(--font-ui);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.bcc-lv {
    font-size: 0.65rem;
    font-family: var(--font-ui);
    font-weight: 700;
    color: #b2bec3;
}
.bcc-type {
    display: none;
}

/* 空槽：绿色调虚线 & 点阵呼吸 */
.box-char-card.empty {
    border: 2px dashed #00b894;
    background: rgba(0, 184, 148, 0.02);
    opacity: 0.6;
    box-shadow: none;
}
.box-char-card.empty:hover {
    opacity: 1;
    border-color: #55efc4;
    background-image: radial-gradient(#7af2d0 1px, transparent 1px);
    background-size: 8px 8px;
    transform: skewX(var(--s-deg)) translateY(-2px);
}
.box-char-card.empty .bcc-name {
    color: rgba(0, 184, 148, 0.4);
    -webkit-text-stroke: 0;
    font-weight: 900;
    font-style: italic;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    transition: color 0.2s ease, -webkit-text-stroke 0.2s ease;
}
.box-char-card.empty.selected {
    border: 2px solid #00b894 !important;
    background: #dbfff8;
    background-image: none;
    opacity: 1;
}
.box-char-card.empty:hover .bcc-name {
    color: rgba(122, 242, 208, 0.85);
}
.box-char-card.empty.selected .bcc-name {
    color: #00b894;
}

/* =========================================
   2. LOWER AREA: Cloud Storage Container
   ========================================= */

.box-storage-area {
    background-color: rgba(250, 251, 252, 0.95);
    background-image: 
        linear-gradient(rgba(0, 184, 148, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 184, 148, 0.03) 1px, transparent 1px);
    background-size: 20px 20px;
  
    border: 1px solid #fff;
    border-top: 4px solid #00b894;
    border-radius: 12px;
  
    box-shadow: 
        inset 0 4px 12px rgba(0,0,0,0.02),
        0 10px 30px -10px rgba(0, 184, 148, 0.1);
      
    position: relative;
    transform: none;
    overflow: hidden;
    padding: 12px;
    height: 700px;
}

.box-storage-matrix {
    background-color: rgba(0, 184, 148, 0.02);
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(72px, 1fr));
    gap: 12px;
    transform: none;
    height: 100%;
    overflow-y: auto;
    padding: 10px;
    padding-bottom: 80px; 
    scroll-behavior: smooth;
    background-image: 
        linear-gradient(rgba(0, 184, 148, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 184, 148, 0.05) 1px, transparent 1px);
    background-size: 20px 20px;
}

.box-storage-matrix::-webkit-scrollbar { width: 4px; }
.box-storage-matrix::-webkit-scrollbar-track { background: transparent; }
.box-storage-matrix::-webkit-scrollbar-thumb {
    background: #dcdde1; 
    border-radius: 4px;
}

/* 3. 仓库单元格 (正圆角风格) */
.storage-cell {
    position: relative;
    aspect-ratio: 1 / 1;
    background: #fff;
    border-radius: 8px;
    border: 2px solid rgba(0, 184, 148, 0.15);
    cursor: pointer;
  
    display: flex; flex-direction: column; 
    align-items: center; justify-content: center;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.02);
  
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    z-index: 1;
}

.storage-cell:hover:not(.empty) {
    transform: translateY(-2px) scale(1.05);
    border-color: #55efc4;
  
    background-color: #ecfff6;
    background-image: radial-gradient(rgba(0, 184, 148, 0.25) 1px, transparent 1px);
    background-size: 6px 6px;
  
    box-shadow: 
        0 5px 15px -3px rgba(0, 184, 148, 0.15),
        0 0 0 1px #55efc4; 
    z-index: 10;
}

.storage-cell.selected {
    border-color: #00b894;
    border-width: 1px;
    background: #e6fffa;
    background-image: none;
  
    box-shadow: 
        0 0 0 1px rgba(0, 184, 148, 0.9),
        0 6px 12px -2px rgba(0, 184, 148, 0.25);
  
    transform: translateY(-2px);
    z-index: 5;
}

.storage-cell.selected::after {
    content: ''; 
    position: absolute;
    top: -6px; right: -6px;
    width: 22px; height: 22px;
    background: #00b894 url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='4' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E") no-repeat center center;
    background-size: 14px;
    border: 2px solid #fff;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.sc-img {
    width: 70%; height: 70%;
    object-fit: contain;
    image-rendering: auto;
    filter: drop-shadow(0 2px 3px rgba(0,0,0,0.06));
    transition: transform 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);
}
.sc-img.regional-icon {
    width: 90%; height: 90%;
    transform: translateY(-6px);
}
.storage-cell:hover .sc-img, 
.storage-cell.selected .sc-img {
    transform: scale(1.2);
}
.storage-cell:hover .sc-img.regional-icon,
.storage-cell.selected .sc-img.regional-icon {
    transform: translateY(-6px) scale(1.2);
}

.sc-lv {
    position: absolute;
    bottom: 2px;
    font-size: 0.55rem;
    font-weight: 800;
    font-family: var(--font-ui);
    color: #636e72;
    background: rgba(255,255,255,0.8);
    padding: 1px 4px;
    border-radius: 4px;
}
.storage-cell:hover .sc-lv,
.storage-cell.selected .sc-lv {
    color: #006266;
    background: rgba(85, 239, 196, 0.3);
}

.sc-shiny {
    position: absolute;
    top: 4px; left: 4px;
    color: #f1c40f;
    font-size: 0.8rem;
    filter: drop-shadow(0 0 2px #fff);
    z-index: 2;
}

/* 5. 空白单元格 */
.storage-cell.empty {
    border: 2px dashed rgba(0, 184, 148, 0.3);
    background: rgba(0, 184, 148, 0.02);
    transform: none; 
    opacity: 0.6;
    transition: all 0.2s;
    box-shadow: none;
}
.storage-cell.empty:hover {
    opacity: 1;
    border-color: #00cec9;
    border-style: solid;
    transform: scale(0.98);

    background-color: #e0fbf6;
    background-image: radial-gradient(rgba(0, 184, 148, 0.4) 1px, transparent 1px);
    background-size: 10px 10px; 
}
.storage-cell.empty.selected {
    border: 2px solid #00b894;
    background: rgba(85, 239, 196, 0.2);
    background-image: none;
    box-shadow: inset 0 0 10px rgba(0, 184, 148, 0.2);
    transform: none;
    opacity: 1;
}

/* --- BOTTOM: 悬浮操作控制台 (Remastered) --- */
/* 拒绝死黑板，改用磨砂玻璃 Floating Bar，增加呼吸感 */

.box-ops-bar {
    position: fixed;
    /* 稍微悬空，增加层次 */
    bottom: 25px; 
    left: 20px; right: 20px;
    max-width: 500px;
    margin: 0 auto;  /* 居中保护 */
  
    height: auto;
    /* 磨砂玻璃深色底 */
    background: rgba(45, 52, 54, 0.85); /* 半透明黑灰 */
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
  
    /* 边框发光 */
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 
        0 15px 40px rgba(0,0,0,0.35),
        0 0 0 1px rgba(0,0,0,0.1);
      
    border-radius: 12px;
    padding: 16px;
  
    /* 入场动画 */
    transform: translateY(120%) scale(0.95);
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
    display: flex;
    flex-direction: column;
    gap: 12px;
    z-index: 999;
}

.box-ops-bar.active {
    transform: translateY(0) scale(1);
    opacity: 1;
}

/* 提示文字行 */
.ops-text-row {
    background: rgba(0,0,0,0.2);
    border-radius: 6px;
    padding: 8px 12px;
    display: flex;
    align-items: center;
    border-left: 3px solid #74b9ff; /* 默认蓝色指引 */
}

.ops-log {
    font-family: 'Exo 2', sans-serif; /* 确保用科技字体 */
    color: #dfe6e9;
    font-size: 0.9rem;
    font-weight: 500;
    letter-spacing: 0.5px;
    line-height: 1.3;
}

/* 高亮词：加底色块 */
.ops-highlight {
    color: #fff;
    background: #00cec9;
    padding: 1px 6px;
    border-radius: 3px;
    font-weight: 800;
    font-size: 0.85rem;
    margin: 0 2px;
    box-shadow: 0 2px 5px rgba(0, 206, 201, 0.3);
    display: inline-block;
    transform: skewX(-5deg); /* 文字高亮再次倾斜 */
}

/* 按钮行：两端对齐 */
.ops-action-row {
    display: grid;
    grid-template-columns: 1fr 2fr; /* RESET占1，EXECUTE占2 */
    gap: 12px;
}

.btn-ops-cancel, .btn-ops-confirm {
    height: 44px;
    border: none;
    border-radius: 6px;
  
    font-family: var(--font-ui);
    font-weight: 900;
    font-size: 0.95rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: transform 0.1s;
}

/* 取消按钮：幽灵式 */
.btn-ops-cancel {
    background: transparent;
    color: #636e72;
    background: #fff;
    border: 2px solid #ebedf0;
    box-shadow: 0 4px 0 #dfe6e9;
}
.btn-ops-cancel:active {
    transform: translateY(2px);
    box-shadow: 0 2px 0 #dfe6e9;
}

/* 确认按钮：核心风格 - 使用斜纹背景和强阴影 */
.btn-ops-confirm {
    /* 渐变主色 */
    background: linear-gradient(135deg, #00b894 0%, #55efc4 100%);
    color: #0e3d32; /* 深色字增加对比度 */
  
    /* 按钮底 */
    box-shadow: 
        0 4px 0 #009174,
        0 8px 20px rgba(0, 184, 148, 0.35);
      
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

/* 给确认按钮加一点流光动画 */
.btn-ops-confirm::after {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 50%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transform: skewX(-20deg);
    animation: confirmSheen 3s infinite ease-in-out;
}
@keyframes confirmSheen {
    0% { left: -100%; }
    20% { left: 150%; }
    100% { left: 150%; }
}

.btn-ops-confirm:hover {
    filter: brightness(1.05);
    transform: translateY(-1px);
    box-shadow: 0 6px 0 #009174, 0 12px 25px rgba(0, 184, 148, 0.4);
}
.btn-ops-confirm:active {
    transform: translateY(4px);
    box-shadow: 0 0 0 #009174;
}

/* =========================================
   [IMPROVED] COPY NOTIFICATION
   更具科技感的横幅提示，不再是绿方块
   ========================================= */
.copy-notification {
    position: fixed;
    top: 60px; /* 从顶部滑入 */
    left: 20px; right: 20px;
    max-width: 400px;
    margin: 0 auto;
  
    background: rgba(30, 30, 35, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 0 1px rgba(85, 239, 196, 0.5); /* 绿色描边 */
    backdrop-filter: blur(16px);
    border-radius: 6px;
  
    /* 倾斜切角左上右下 */
    transform: skewX(-15deg) translateY(-20px);
  
    padding: 12px 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    z-index: 9999;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
}

.copy-notification.show {
    opacity: 1;
    transform: skewX(-15deg) translateY(0); /* 滑入 */
}

/* 内部内容反转以保持正 */
.copy-notif-internal {
    transform: skewX(15deg);
    display: flex; 
    align-items: center; 
    gap: 15px; 
    width: 100%;
}

.copy-notif-icon {
    font-size: 1.5rem;
    color: #55efc4;
    display: flex; align-items: center;
}

.copy-notif-text {
    font-family: var(--font-ui);
    color: #fff;
    line-height: 1.2;
}
.copy-notif-title {
    font-weight: 800;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #55efc4; /* Tech Green */
}
.copy-notif-desc {
    font-size: 0.75rem;
    color: #b2bec3;
    font-weight: 500;
}

@keyframes scanline {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(200%); }
}
/* 扫描线特效 */
.copy-notification::after {
    content: '';
    position: absolute;
    top: 0; bottom: 0; left: 0; right: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
    z-index: -1;
    animation: scanline 2s cubic-bezier(0.4, 0, 0.2, 1);
    pointer-events: none;
}

/* =================================================================
   Responsive 锁区界面 FIX V6.0 (Stable & Centered)
   ================================================================= */
.box-offline-overlay {
    position: fixed;
    top: 50px;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1000;
    background-color: #f4f6f8;
    background-image: 
        linear-gradient(#e1e4e8 1px, transparent 1px),
        linear-gradient(90deg, #e1e4e8 1px, transparent 1px);
    background-size: 20px 20px;
    background-position: center;
    backdrop-filter: blur(8px);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.box-offline-overlay::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: repeating-linear-gradient(
        -45deg,
        #dfe4ea,
        #dfe4ea 10px,
        #ff7675 10px,
        #ff7675 20px
    );
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.boo-bg-deco {
    position: absolute;
    bottom: -10%;
    left: -10%;
    transform: rotate(-15deg);
    font-size: 12rem;
    font-weight: 900;
    font-family: Arial, sans-serif;
    color: rgba(0,0,0,0.03);
    white-space: nowrap;
    z-index: 0;
    pointer-events: none;
    user-select: none;
}

.boo-content {
    position: relative;
    z-index: 5;
    background: #ffffff;
    border-top: 5px solid #ff7675;
    border-radius: 12px;
    box-shadow: 
        0 15px 35px -5px rgba(0,0,0,0.15), 
        0 5px 15px rgba(0,0,0,0.05),
        0 0 0 1px rgba(0,0,0,0.02);
    width: 320px;
    padding: 40px 30px;
    text-align: center;
    animation: pop-in 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28) backwards;
    transform-origin: center center;
}

.boo-icon-wrap {
    width: 64px;
    height: 64px;
    margin: 0 auto 20px auto;
    color: #636e72;
}

.boo-svg {
    width: 100%;
    height: 100%;
}

.boo-svg .slash-line {
    stroke: #ff7675;
    stroke-width: 3;
    animation: slash-In 0.5s 0.2s ease-out forwards;
}

.boo-title {
    font-family: 'Exo 2', sans-serif;
    font-size: 2rem;
    font-weight: 900;
    font-style: italic;
    color: #2d3436;
    letter-spacing: -1px;
    text-transform: uppercase;
    margin-bottom: 2px;
    text-shadow: 2px 0 0 rgba(255,0,0,0.1), -2px 0 0 rgba(0,255,255,0.1);
}

.boo-code {
    font-family: monospace;
    color: #b2bec3;
    font-size: 0.8rem;
    margin-bottom: 15px;
    letter-spacing: 1px;
    display: block;
}

.boo-alert-box {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px dashed #dfe6e9;
    width: 100%;
}

.boo-main-reason {
    font-size: 0.95rem;
    font-weight: 800;
    color: #d63031;
    margin-bottom: 6px;
    line-height: 1.4;
}

.boo-hint {
    font-size: 0.75rem;
    color: #636e72;
    background: #f1f2f6;
    padding: 6px 12px;
    border-radius: 4px;
    display: inline-block;
}

.boo-terminal {
    font-family: 'Consolas', monospace;
    font-size: 0.7rem;
    color: #95a5a6;
    margin-top: 8px;
    text-align: center;
    z-index: 5;
    opacity: 0.8;
}

.boo-terminal span {
    display: block;
    margin-bottom: 2px;
}

.blink {
    display: inline-block;
    width: 6px;
    height: 10px;
    background: #2d3436;
    vertical-align: middle;
    margin-left: 2px;
    animation: cursor-blink 1s step-end infinite;
}

@keyframes pop-in {
    0% { transform: scale(0.9) translateY(20px); opacity: 0; }
    100% { transform: scale(1) translateY(0); opacity: 1; }
}

@keyframes slash-In {
    to { stroke-dashoffset: 0; }
}

@keyframes cursor-blink {
    50% { opacity: 0; }
}

#pg-box.locked .box-header-strip,
#pg-box.locked .box-party-grid, 
#pg-box.locked .box-storage-area {
    display: none !important;
}

/* =========================================
   P-SYSTEM DASHBOARD (白色系 / Light Mode)
   赛博朋克风格仪表盘 - 清爽白底版
   ========================================= */

/* Dashboard 页面容器 */
#pg-dashboard.page {
    padding: 0 !important;
    gap: 8px !important;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    display: none !important;
    align-content: start !important;
}

#pg-dashboard.page.curr {
    display: flex !important;
}

/* Hero 欢迎区域 (TRAINER 卡片) */
.p-hero-dash {
    position: relative !important;
    overflow: visible !important;
    height: auto;
    min-height: 80px;
    flex-shrink: 0;
    margin: 0 0 0 0 !important;
    border-left-width: 0px;
    border-bottom: 3px solid var(--c-cyan, #00cec9);
    padding: 15px 24px;
    background: #fff;
    border-radius: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 5px 15px -10px rgba(0,0,0,0.1);
    animation: slideUpFade 0.4s ease-out;
    z-index: 5;
}
.p-hero-dash > * {
    transform: none;
}
.hero-main {
    flex: 1;
}
/* Dashboard 中的 mech-wrapper 绝对定位 */
.p-hero-dash .mech-wrapper {
    position: absolute !important;
    top: 18px !important;
    right: 24px !important;
    height: 10px;
    margin: 0 !important;
    z-index: 50;
}
.p-hero-dash .mech-matrix.icon-mode {
    top: 0;
    right: 24px;
    display: flex;
    align-items: center;
    border-radius: 4px;
    transform: skewX(-15deg);
}
.p-hero-dash .mech-matrix.icon-mode.expanded {
    transform: skewX(-15deg);
    padding: 3px 6px;
}

.p-hero-dash .mech-btn {
    margin-top: 8px;
}

@keyframes slideUpFade {
    0% { opacity: 0; transform: translateY(10px); }
    100% { opacity: 1; transform: translateY(0); }
}

.hero-welcome { 
    font-size: 0.65rem; 
    color: rgba(45,52,54,0.5);
    font-weight: 700; 
    letter-spacing: 1.5px;
    text-transform: uppercase;
    opacity: 0.6;
}
.hero-name { 
    margin-top: 5px;
    font-size: 2.4rem; 
    font-weight: 900; 
    font-style: italic; 
    line-height: 1;
    text-transform: uppercase;
    letter-spacing: -2px;
    font-family: var(--font-ui);
    color: #2d3436;
    text-shadow: 3px 3px 0px rgba(0,0,0,0.05);
}
.hero-zone {
    font-size: 0.7rem; 
    background: var(--c-cyan, #00cec9); 
    color: #fff;
    display: inline-block; 
    padding: 3px 10px; 
    border-radius: 3px;
    font-weight: 800; 
    margin-top: 8px; 
    transform: skewX(-10deg);
    box-shadow: 2px 2px 0 rgba(0, 206, 201, 0.3);
}
.hero-zone span {
    display: inline-block;
    transform: skewX(6deg);
}

/* =========================================================
   HERO META ROW + GHOST BAG BUTTON
   ========================================================= */
.hero-meta-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 8px;
    transform: skewX(-6deg);
}

.p-hero-dash .hero-zone {
    margin-top: 0 !important;
    transform: skewX(-6deg);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 24px;
    font-size: 0.7rem;
    background: var(--c-cyan, #00cec9);
    color: #fff;
    padding: 0 10px;
    border-radius: 3px;
    font-weight: 800;
    box-shadow: 2px 2px 0 rgba(0, 206, 201, 0.3);
}

.p-hero-dash .hero-zone span {
    transform: skewX(6deg);
}

/* ========================
   MOSAIC GRID SYSTEM
   ======================== */
.mosaic-grid {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    grid-template-rows: auto auto auto auto min-content;
    gap: 14px;
    flex: 1;
    overflow: hidden !important;
    margin-top: 0 !important;
    width: 100%;
    box-sizing: border-box;
    align-content: start;
    padding: 4px 0px 0px 0px !important;
    -ms-overflow-style: none;
    scrollbar-width: none;
}
.mosaic-grid::-webkit-scrollbar { display: none; }

/* ========================
   LIVE TILE (万能磁贴块)
   ======================== */
.live-tile {
    padding: 0;
    display: flex;
    position: relative;
    background: #fff;
    border-radius: 12px;
    border: 1px solid #f1f3f5 !important;
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    overflow: hidden;
    transition: all 0.2s;
    align-items: center;
    justify-content: center;
    background-image: none !important;
}

/* 1.5 DEPLOYED UNIT (PARTY快捷入口) - REMASTERED */
.tile-party {
    --tile-color: #ff4757;
    --tile-r: 255; --tile-g: 71; --tile-b: 87;
    grid-column: span 12;
    height: 85px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 
        0 4px 12px rgba(0,0,0,0.04), 
        0 1px 2px rgba(0,0,0,0.02);
    border: 1px solid #e2e6ea;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 24px;
}

.tile-party:active {
    transform: scale(0.98);
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
}


.tile-party::after {
    display: none !important;
}

.tp-watermark {
    position: absolute;
    right: -25px;
    bottom: -35px;
    width: 130px;
    height: 130px;
    opacity: 0.05;
    color: #2d3436;
    margin: 0;
    pointer-events: none;
    transform: rotate(-15deg);
    z-index: 0;
    fill: currentColor;
    transition: all 0.5s ease;
}

.tp-roster-container {
    z-index: 5;
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 4px;
    height: 100%;
    padding-left: 0;
    padding-top: 40px;
    margin-left: -45px;
}

.roster-slot {
    width: 44px;
    height: 55px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.pk-icon {
    width: 75px;
    height: 75px;
    object-fit: contain;
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.15));
    transform: translateY(-10px);
    transition: transform 0.2s cubic-bezier(0.3, 1.5, 0.5, 1);
}

.tile-party:hover .pk-icon {
    transform: scale(1.15) translateY(-15px);
}

.tile-party:hover .roster-slot:nth-child(1) .pk-icon { transition-delay: 0.00s; }
.tile-party:hover .roster-slot:nth-child(2) .pk-icon { transition-delay: 0.05s; }
.tile-party:hover .roster-slot:nth-child(3) .pk-icon { transition-delay: 0.10s; }
.tile-party:hover .roster-slot:nth-child(4) .pk-icon { transition-delay: 0.15s; }
.tile-party:hover .roster-slot:nth-child(5) .pk-icon { transition-delay: 0.20s; }
.tile-party:hover .roster-slot:nth-child(6) .pk-icon { transition-delay: 0.25s; }

.empty-dot {
    width: 5px;
    height: 5px;
    background: #dfe6e9;
    border-radius: 50%;
}

.tile-party:hover .tp-watermark {
    opacity: 0.08;
    transform: rotate(0deg) scale(1.1);
    color: #ff4757;
}

/* ========================================================
   MAIN VIEWPORT (主视口间距)
   ======================================================== */
.main-viewport {
    padding-top: 50px !important;
}

/* ========================================================
   [FINAL FIX] SYSTEM STATUS BAR - 顶栏完全体
   ======================================================== */
.p-status-bar {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 44px;
    z-index: 2000;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 18px;
    box-sizing: border-box;
    font-family: var(--font-ui), system-ui, -apple-system, sans-serif;
    color: #636e72;
    background: rgba(246, 247, 249, 0.85);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(0,0,0,0.06);
    box-shadow: 0 1px 3px rgba(0,0,0,0.02);
    transition: all 0.3s;
}

.ps-left {
    display: flex;
    align-items: center;
    width: 80px;
    height: 100%;
    position: relative;
}

.net-group {
    display: flex;
    align-items: center;
    gap: 6px;
    opacity: 1;
    transform: translateX(0);
    transition: all 0.3s ease;
}

.net-signal {
    display: flex;
    align-items: flex-end;
    gap: 2px;
    height: 12px;
}
.n-bar {
    width: 3px;
    background: #b2bec3;
    border-radius: 2px;
}
.n-bar:nth-child(1) { height: 40%; }
.n-bar:nth-child(2) { height: 60%; }
.n-bar:nth-child(3) { height: 80%; background: #636e72; }
.n-bar:nth-child(4) { height: 100%; background: #636e72; }

.net-label {
    font-size: 0.75rem;
    font-weight: 800;
    font-style: italic;
    color: #b2bec3;
}

.back-trigger {
    position: absolute;
    left: 0;
    display: flex;
    align-items: center;
    gap: 4px;
    cursor: pointer;
    opacity: 0;
    pointer-events: none;
    transform: translateX(-10px);
    transition: all 0.3s ease 0.1s;
}

.p-status-bar.sub-mode .net-group {
    opacity: 0;
    pointer-events: none;
    transform: translateX(-10px);
    position: absolute;
}

.p-status-bar.sub-mode .back-trigger {
    opacity: 1;
    pointer-events: auto;
    transform: translateX(0);
}

.back-icon {
    width: 20px;
    color: #ff7675;
}

.back-txt {
    font-size: 0.8rem;
    font-weight: 800;
    color: #2d3436;
}

.ps-center {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    font-size: 0.9rem;
    font-weight: 800;
    color: #2d3436;
}

.ps-right {
    display: flex;
    align-items: center;
    width: 80px;
    justify-content: flex-end;
    gap: 5px;
}

.batt-val {
    font-size: 0.75rem;
    font-weight: 700;
    color: #b2bec3;
    letter-spacing: 0.5px;
    margin-top: 1px;
}

.batt-shell {
    width: 24px;
    height: 11px;
    border: 1.5px solid #b2bec366;
    border-radius: 4px;
    padding: 1.5px;
    position: relative;
    display: flex;
    align-items: center;
}

.batt-shell::after {
    content: '';
    position: absolute;
    right: -4.5px;
    top: 50%;
    transform: translateY(-50%);
    width: 2.5px;
    height: 4px;
    background: #b2bec380;
    border-radius: 0 2px 2px 0;
}

.batt-fill {
    height: 100%;
    width: 94%;
    border-radius: 1.5px;
    background: #636e72;
}


/* ========================================================
   MECH-BAR (机制条样式)
   ======================================================== */
.mech-btn {
    height: 22px;
    width: 22px;
    border-radius: 3px;
    background: #e2e6ea;
    border: none;
    box-shadow: none;
}

.mech-btn svg {
    width: 18px;
    height: 18px;
    stroke-width: 4;
    transform: skewX(15deg) scale(1) translateY(0);
}

.mech-btn.open svg {
    transform: skewX(15deg) rotate(180deg);
}

.mech-matrix.icon-mode .cell {
    height: 20px;
}

.mech-matrix.icon-mode.expanded .cell {
    width: 20px;
}

.mech-matrix.icon-mode.expanded .cell svg {
    transform: skewX(15deg);
    color: #b2bec3;
}

.mech-matrix.icon-mode.expanded .cell[data-mech="mega"] svg,
.mech-matrix.icon-mode.expanded .cell[data-mech="style"] svg {
    transform: skewX(15deg) translateY(1px);
}

/* =========================================
   [优化] Hero Action Button (背包按钮重做)
   ========================================= */
.hero-bag-btn.refined {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 24px;
    padding: 0 12px 0 10px;
    background: #2d3436;
    border: 1px solid #636e72;
    border-radius: 4px;
    color: #fff;
    cursor: pointer;
    transform: skewX(-10deg);
    box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.1);
    transition: all 0.2s cubic-bezier(0.18, 0.89, 0.32, 1.28);
    overflow: hidden;
    position: relative;
    user-select: none;
}

.hero-bag-btn.refined .hbb-icon {
    width: 14px;
    height: 14px;
    margin-right: 6px;
    margin-top: -1px;
    transform: skewX(10deg);
    display: flex;
    align-items: center;
    justify-content: center;
}

.hero-bag-btn.refined .hbb-icon svg {
    width: 100%;
    height: 100%;
    stroke: #b2bec3;
    stroke-width: 2.2;
    transition: stroke 0.2s;
}

.hero-bag-btn.refined .hbb-text {
    font-family: var(--font-ui);
    font-weight: 800;
    font-size: 0.7rem;
    letter-spacing: 0.5px;
    line-height: 1;
    transform: skewX(10deg);
    color: #dfe6e9;
}

.hero-bag-btn.refined:hover {
    background: #0984e3;
    border-color: #74b9ff;
    transform: skewX(-6deg) translateY(-2px);
    box-shadow: 3px 4px 10px rgba(9, 132, 227, 0.3);
}

.hero-bag-btn.refined:hover .hbb-icon svg,
.hero-bag-btn.refined:hover .hbb-text {
    stroke: #fff;
    color: #fff;
}

.hero-bag-btn.refined:active,
.hero-bag-btn.refined.is-pressing {
    transform: skewX(-6deg) translateY(1px) scale(0.98);
    box-shadow: none;
    background: #00cec9;
    border-color: #00cec9;
}

.hero-bag-btn.refined.is-pressing {
    animation: simpleClick .2s ease forwards;
}

/* =========================================
   [Layout V3] 重构的 "Magazine" 风格栅格
   ========================================= */
.mosaic-grid.layout-v3 {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr) !important;
    grid-auto-rows: min-content;
    gap: 12px !important;
    padding: 4px 10px 50px 10px !important;
    align-content: start !important;
    grid-template-rows: unset !important;
}

/* =========================================
   [修复] Party 卡片回归 & 版面微调
   ========================================= */
.mosaic-grid.layout-v3 .tile-party,
.mosaic-grid.layout-v3 .full-width {
    grid-column: 1 / span 2 !important;
    width: calc(100% - 40px);
    margin: 0 auto 2px;
    height: 85px;
}

/* =========================================
   [Layout Mod] 底部三分停靠栏
   ========================================= */
.bottom-dock-layer {
    grid-column: 1 / span 2;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-top: -10px;
}

.bottom-dock-layer .live-tile {
    grid-column: span 1 !important;
    height: 70px !important;
    padding: 0 10px !important;
}

/* =========================================
   [IMPACT] PARTY 核心重制 - 指挥官模式
   ========================================= */
.mosaic-grid.layout-v3 .tile-party.remodel {
    grid-column: 1 / span 2 !important;
    height: 120px !important;
    background: #fff;
    border: 1px solid #e1e4e8;
    border-bottom: 4px solid #ff94a3;
    border-radius: 16px;
    position: relative;
    overflow: hidden;
    padding: 0 16px 0 24px !important;
    display: flex;
    justify-content: flex-start;
    align-items: center;
    gap: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.04);
}

.tp-bg-decoration {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 0;
}

.tp-giant-watermark {
    position: absolute;
    right: -20px;
    top: -40px;
    width: 200px;
    height: 200px;
    color: #2d3436;
    opacity: 0.04;
    transform: rotate(20deg);
}

.tile-party.remodel:hover .tp-giant-watermark {
    opacity: 0.08;
    transform: rotate(45deg) scale(1.1);
    transition: 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
    color: #ff4757;
}

.tp-red-glow {
    position: absolute;
    width: 400px;
    height: 100%;
    left: -100px;
    top: 0;
    background: radial-gradient(circle at center, rgba(255, 71, 87, 0.08) 0%, transparent 70%);
}

.tp-stripe-bg {
    position: absolute;
    inset: 0;
    background-image: repeating-linear-gradient(45deg, rgba(0,0,0,0.02) 0px, rgba(0,0,0,0.02) 2px, transparent 2px, transparent 10px);
}

.tp-content-left {
    flex: 0 0 115px !important;
    width: 115px !important;
    z-index: 5;
    display: flex;
    flex-direction: column;
    justify-content: center;
    overflow: visible;
    white-space: nowrap;
    margin-right: 5px;
}

.tp-top-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: -2px;
}

.tp-label-main {
    font-family: var(--font-ui);
    font-weight: 900;
    font-size: 1.5rem;
    font-style: italic;
    color: #2d3436;
    letter-spacing: -0.5px;
    white-space: nowrap;
    line-height: 1;
}

.tp-big-counter {
    line-height: 1;
    margin-top: 6px;
}

.curr-val {
    font-family: var(--font-ui);
    font-size: 2.8rem !important;
    font-weight: 800;
    color: #2d3436;
    letter-spacing: -2px;
}

.mosaic-grid.layout-v3 .tile-party.remodel {
    padding-right: 14px !important;
}

.max-val {
    font-family: var(--font-ui);
    font-size: 1rem;
    color: #b2bec3;
    font-weight: 700;
    margin-left: -5px;
}

.tp-roster-container {
    z-index: 5;
    flex: 1;
    display: flex;
}

.tp-roster-container .roster-slot {
    flex: 0 0 auto !important;
    width: 42px !important;
    height: 42px !important;
    max-width: none !important;
    border-radius: 6px !important;
    border: 1.5px dashed rgba(45, 52, 54, 0.15) !important;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(45, 52, 54, 0.05);
    transition: all 0.2s;
}

.tp-roster-container .roster-slot:has(.pk-icon) {
    border: none;
    background: transparent;
}

.tp-roster-container .pk-icon {
    width: 54px !important;
    height: 54px !important;
    transform: translateY(-6px) !important;
    filter: drop-shadow(0 5px 5px rgba(0,0,0,0.25)) !important;
}

.empty-dot {
    display: none !important;
}

/* =========================================
   [TACTICAL UI UPGRADE] 全局战术化样式重构
   ========================================= */

/* --- 1. 高级战术方块 (Box / Relation) --- */
.live-tile.box-tactical {
    position: relative;
    background: #fff;
    border: 1px solid #e1e4e8;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 16px;
    height: 160px;
    margin: 0;
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border-radius: 14px;
    z-index: 1;
}

.live-tile.theme-teal { border-bottom: 4px solid #66eed0; color: #0f9d7c; }
.live-tile.theme-purple { border-bottom: 4px solid #ffb5e0; color: #d452a2; }
.live-tile.theme-blue { border-bottom: 4px solid #b7dcff; color: #4a90e2; }

/* BOX/MAP/UNIT 底部边框强化，保持与其他磁贴一致 */
.box-tactical.theme-teal { border-bottom: 4px solid #66eed0 !important; }
.box-tactical.theme-purple { border-bottom: 4px solid #ffb5e0 !important; }
.box-tactical.theme-blue { border-bottom: 4px solid #b7dcff !important; }
.box-tactical.theme-teal,
.box-tactical.theme-purple {
    height: 150px !important;
}
.live-tile.box-tactical::after {
    content: '';
    position: absolute;
    left: 24px;
    right: 24px;
    bottom: -14px;
    height: 24px;
    border-radius: 14px;
    background: var(--tile-shadow-fill, rgba(0, 0, 0, 0.08));
    box-shadow: 0 10px 18px rgba(0, 0, 0, 0.08);
    opacity: 0.9;
    z-index: -1;
    transition: opacity 0.2s ease, transform 0.2s ease;
}

.live-tile.theme-teal { --tile-shadow-fill: rgba(0, 184, 148, 0.18); }
.live-tile.theme-purple { --tile-shadow-fill: rgba(255, 181, 224, 0.24); }
.live-tile.theme-blue { --tile-shadow-fill: rgba(116, 185, 255, 0.2); }
.live-tile.theme-amber { --tile-shadow-fill: rgba(253, 203, 110, 0.25); }
.live-tile.theme-slate,
.live-tile.theme-theme-slate,
.live-tile.theme-gray { --tile-shadow-fill: rgba(99, 110, 114, 0.18); }
.live-tile.theme-orange { border-bottom: 4px solid #ffd7cc; }

.t-decoration { position: absolute; inset: 0; pointer-events: none; }

.t-watermark {
    position: absolute;
    right: -20px;
    top: -30px;
    width: 140px;
    height: 140px;
    opacity: 0.05;
    color: #2d3436;
    transform: rotate(15deg);
    transition: 0.4s;
}

.t-stripe {
    position: absolute;
    inset: 0;
    background-image: repeating-linear-gradient(45deg, rgba(0,0,0,0.02) 0px, rgba(0,0,0,0.02) 2px, transparent 2px, transparent 12px);
    opacity: 0.7;
}

.t-content {
    z-index: 2;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
}

.t-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 1px dotted rgba(0,0,0,0.1);
    padding-bottom: 6px;
    margin-bottom: auto;
}

.t-id {
    font-family: var(--font-ui);
    font-size: 0.6rem;
    font-weight: 800;
    opacity: 0.6;
    padding-top: 2px;
}

.t-icon-sm { width: 18px; height: 18px; opacity: 0.8; color: inherit; }

.t-main-data { text-align: left; }

.t-num {
    font-family: var(--font-ui);
    font-size: 2.2rem;
    font-weight: 900;
    line-height: 1;
    color: #2d3436;
    letter-spacing: -1px;
}

.t-num small {
    font-size: 0.9rem;
    color: #b2bec3;
    font-weight: 700;
    margin-left: 2px;
}

.t-label {
    font-size: 0.9rem;
    font-weight: 900;
    font-style: italic;
    color: #2d3436;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

.t-status {
    font-size: 0.5rem;
    font-weight: 800;
    margin-top: 2px;
    opacity: 0.8;
    color: inherit;
}

.map-bg-grid {
    position: absolute;
    inset: 0;
    background-image:
        linear-gradient(rgba(116, 185, 255, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(116, 185, 255, 0.1) 1px, transparent 1px);
    background-size: 20px 20px;
}

.map-radar-ring {
    position: absolute;
    width: 60%;
    padding-bottom: 60%;
    border: 1px solid rgba(116, 185, 255, 0.4);
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(116, 185, 255, 0.1);
}

.map-radar-ring::after {
    content: '';
    position: absolute;
    inset: 10%;
    border: 1px dashed rgba(116, 185, 255, 0.3);
    border-radius: 50%;
}

/* =========================================
   [IMPROVED v2] 统一家族化外观：两段式渐变色块
   ========================================= */

/* 1. 家族渐变底色 */
.live-tile.theme-teal {
    background: linear-gradient(170deg, #ffffff 50%, #dcfbf2 80%, #bffcf0 100%) !important;
}
.live-tile.theme-purple {
    background: linear-gradient(170deg, #ffffff 50%, #ffe3f4 80%, #ffd3ec 100%) !important;
}
.live-tile.theme-blue {
    background: linear-gradient(180deg, #ffffff 50%, #e8f4fd 80%, #d6ecff 100%) !important;
    border-bottom: 4px solid #c5e1f5;
    color: #4a90e2;
}

.theme-teal .t-main-data,
.theme-purple .t-main-data,
.theme-blue .t-main-data {
    position: relative;
    z-index: 5;
}

/* 主题色标题文本（数值/副标题） */
.theme-teal .t-num,
.theme-teal .t-label { color: #0f9d7c; }

.theme-purple .t-num,
.theme-purple .t-label { color: #d452a2; }

.theme-blue .t-num,
.theme-blue .t-label { color: #3d7dc3; }

.theme-amber .t-num,
.theme-amber .t-label { color: #ce6a1d; }

.theme-gray .t-num,
.theme-gray .t-label,
.theme-slate .t-num,
.theme-slate .t-label { color: #4f5a63; }

/* MAP HUD 标题 & 坐标主题色 */
.theme-blue .mh-zone { color: #3d7dc3; }
.theme-blue .mh-coords { color: #3d7dc3; }
.theme-blue .mh-coords .axis { color: #5dade2; }

/* TRANSIT / WORK 小块标题 */
.theme-amber .mini-title-big { color: #ce6a1d; }
.theme-slate .mini-title-big,
.theme-gray .mini-title-big { color: #4f5a63; }

.t-watermark.logo-mode {
    opacity: 0.08;
    width: 120px;
    height: 120px;
    top: -10px;
    right: -10px;
}

/* 2. Tactical Map Pro 调整 */
.tactical-map-pro {
    align-items: stretch !important;
    justify-content: flex-start !important;
}

.tile-tall-map {
    height: 150px !important;
}

.t-map-visual {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: -10px;
    margin-bottom: 5px;
}

.radar-ping {
    position: absolute;
    width: 80px;
    height: 80px;
    border: 1px solid rgba(116, 185, 255, 0.5);
    border-radius: 50%;
    animation: pingOpac 3s infinite;
}
.radar-ping::after {
    content: '';
    position: absolute;
    inset: -4px;
    border: 1px dashed rgba(116, 185, 255, 0.3);
    border-radius: 50%;
}

@keyframes pingOpac {
    0% { transform: scale(0.8); opacity: 0.1; }
    50% { opacity: 0.5; }
    100% { transform: scale(1.2); opacity: 0.1; }
}

.corner-L-bra {
    position: absolute;
    width: 15px;
    height: 15px;
    border: 1.5px solid #74b9ff;
    opacity: 0.6;
}

.corner-L-bra.top-l {
    top: 50%;
    left: 50%;
    transform: translate(-50px, -50px);
    border-right: none;
    border-bottom: none;
}

.corner-L-bra.bot-r {
    top: 50%;
    left: 50%;
    transform: translate(35px, 35px);
    border-left: none;
    border-top: none;
}

.theme-blue .t-status {
    color: #2980b9;
    opacity: 0.7;
}

/* =========================================
   [CSS FIX] 右侧堆叠区对齐 & 窄条战术样式
   ========================================= */
.stack-col {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
    height: 100% !important;
    grid-column: 2 / span 1;
    grid-row: span 2;
}

.theme-amber {
    border-bottom: 4px solid #ffd7cc;
    background: linear-gradient(170deg, #ffffff 40%, #fff7f5 80%, #ffede8 100%) !important;
    color: #e17055;
    position: relative;
    overflow: hidden;
}

.theme-gray {
    border-bottom: 4px solid #cbd4d8;
    background: linear-gradient(170deg, #ffffff 40%, #f6f7f8 80%, #ebedf0 100%) !important;
    color: #636e72;
    position: relative;
    overflow: hidden;
}

/* =========================================
   [REMASTER V3] Stack Column: Mini-Macro Style
   ========================================= */
.box-tactical.small-h {
    position: relative;
    padding: 0 !important;
    height: 82px;
    display: block !important;
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.live-tile.theme-amber {
    background: linear-gradient(160deg, #ffffff 40%, rgba(253, 203, 110, 0.2) 100%) !important;
    border-bottom: 4px solid #ffd7cc !important;
    color: #e67e22;
}

.live-tile.theme-slate,
.live-tile.theme-theme-slate,
.live-tile.theme-gray {
    background: linear-gradient(160deg, #ffffff 40%, rgba(178, 190, 195, 0.2) 100%) !important;
    border-bottom: 4px solid #c9d2d8 !important;
    color: #2d3436;
}

.box-tactical.small-h .t-decoration {
    border-radius: inherit;
    overflow: hidden;
}

.box-tactical.small-h .t-watermark {
    width: 90px;
    height: 90px;
    right: -25px;
    top: -15px;
    opacity: 0.04;
    transform: rotate(15deg);
    color: inherit;
    z-index: 0;
}

.mini-header-icon {
    position: absolute;
    top: 10px;
    left: 14px;
    width: 20px;
    height: 20px;
    opacity: 0.6;
    color: inherit;
    z-index: 2;
}

.mini-header-icon svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 1px 0 rgba(255,255,255,0.8));
}

.mini-body {
    position: absolute;
    bottom: 16px;
    right: 14px;
    left: 14px;
    text-align: right;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: flex-end;
    z-index: 5;
    pointer-events: none;
}

.mini-title-big {
    font-family: var(--font-ui);
    font-size: 1.55rem;
    font-weight: 900;
    font-style: italic;
    line-height: 0.85;
    letter-spacing: -1px;
    color: #2d3436;
    text-shadow: 2px 2px 0 rgba(255,255,255,0.8);
    transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
}

/* =========================================
   [DOCK REMASTER] Bottom Buttons: Micro-Tactical
   ========================================= */
.box-tactical.dock-mode {
    position: relative;
    height: auto !important;
    min-height: 48px;
    background: linear-gradient(180deg, rgba(255,255,255,0.9) 0%, rgba(241,243,246,0.4) 100%) !important;
    border: 1px solid rgba(0,0,0,0.05);
    border-bottom-width: 4px !important;
    border-bottom-style: solid !important;
    padding: 8px 18px !important;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    overflow: hidden;
    border-radius: 8px !important;
    transition: all 0.2s cubic-bezier(0.2, 0.8, 0.2, 1);
}

.dock-news {
    border-bottom-color: #cbc0ff !important;
    color: #6c5ce7;
}

.dock-mart {
    border-bottom-color: #66eed0 !important;
    color: #006266;
}

.dock-config {
    border-bottom-color: #a5aeb5 !important;
    color: #2d3436;
    background: linear-gradient(180deg, #fff 0%, #f1f2f6 100%) !important;
}

.dock-config:hover {
    border-bottom-color: #ffb5b4 !important;
}

.dock-content-row {
    display: flex;
    align-items: baseline;
    justify-content: center;
    gap: 6px;
    z-index: 2;
    pointer-events: none;
}

.dock-icon {
    width: 18px;
    height: 18px;
    opacity: 0.8;
    color: inherit;
    transform: translateY(2px);
}

.dock-icon svg {
    width: 100%;
    height: 100%;
    stroke-width: 2.2;
}

.dock-title {
    font-family: var(--font-ui);
    font-weight: 900;
    font-size: 1rem;
    font-style: italic;
    letter-spacing: -0.5px;
    color: #2d3436;
    line-height: 1;
}

.dock-news .dock-title {
    color: #6c5ce7;
}

.dock-mart .dock-title {
    color: #006266;
}

/* =========================================
   [CSS Mod] MAP 视觉重构：定位点风格
   ========================================= */
.map-point-dot {
    position: relative;
    width: 14px;
    height: 14px;
    background: #74b9ff;
    border: 2px solid #fff;
    border-radius: 50%;
    z-index: 10;
    box-shadow: 0 0 10px #74b9ff;
    animation: dotPulse 2s infinite ease-in-out;
}

@keyframes dotPulse {
    0% { transform: scale(0.9); box-shadow: 0 0 5px #74b9ff; }
    50% { transform: scale(1.1); box-shadow: 0 0 15px #74b9ff, 0 0 25px rgba(116, 185, 255, 0.4); }
    100% { transform: scale(0.9); box-shadow: 0 0 5px #74b9ff; }
}

.map-axis-x,
.map-axis-y {
    position: absolute;
    pointer-events: none;
    z-index: 1;
}

.map-axis-x {
    width: 120px;
    height: 1px;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(90deg, transparent, rgba(116, 185, 255, 0.8), transparent);
}

.map-axis-y {
    width: 1px;
    height: 120px;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(180deg, transparent, rgba(116, 185, 255, 0.8), transparent);
}

.radar-ping {
    border-color: rgba(116, 185, 255, 0.6);
    z-index: 0;
}

.map-radar-ring {
    width: 100px;
    padding-bottom: 100px;
    z-index: 0;
    opacity: 0.4;
}

.t-watermark.logo-mode {
    opacity: 0.06;
    transform: rotate(10deg) scale(1.2);
    right: -30px;
    top: 10%;
}

/* =========================================
   [Typo Mod] MAP卡片底部：坐标读数风格
   ========================================= */
.t-main-data.map-hud-layout {
    display: flex;
    align-items: center;
    gap: 10px;
    padding-left: 2px;
}

.mh-bar {
    width: 3px;
    height: 36px;
    background: #74b9ff;
    box-shadow: 0 0 5px rgba(116, 185, 255, 0.6);
    border-radius: 2px;
}

.mh-col {
    display: flex;
    flex-direction: column;
    justify-content: center;
    line-height: 1;
}

.mh-zone {
    font-family: var(--font-ui);
    font-style: italic;
    font-weight: 900;
    font-size: 1.6rem;
    color: #2d3436;
    letter-spacing: -1px;
}

.mh-coords {
    margin-top: 4px;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 0.65rem;
    font-weight: 700;
    color: #636e72;
    display: flex;
    align-items: center;
    background: rgba(116, 185, 255, 0.1);
    padding: 2px 6px;
    border-radius: 3px;
    width: fit-content;
    white-space: nowrap;
}

.mh-coords .axis {
    color: #74b9ff;
    margin-right: 3px;
    font-size: 0.55rem;
}

.mh-coords .val {
    color: #2d3436;
}

.mh-coords .sep {
    margin: 0 6px;
    opacity: 0.3;
    font-size: 0.6rem;
}

/* =========================================
   [UNIFIED] 统一磁贴悬浮效果
   ========================================= */

/* 基础过渡 */
.live-tile,
.tile-party,
.box-tactical {
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* 统一悬浮效果: 上浮 + 底部边框变亮 + 阴影增强 */
.live-tile.box-tactical:hover,
.tile-party.remodel:hover,
.box-tactical.small-h:hover,
.box-tactical.dock-mode:hover {
    transform: translateY(-4px);
    box-shadow: 
        0 12px 28px -8px rgba(0, 0, 0, 0.12),
        0 4px 10px -4px rgba(0, 0, 0, 0.08);
}

/* 底部边框变亮效果 */
.live-tile.theme-teal:hover { border-bottom-color: #8ff7de !important; }
.live-tile.theme-purple:hover { border-bottom-color: #ffd9ef !important; }
.live-tile.theme-blue:hover { border-bottom-color: #cfe8ff !important; }
.live-tile.theme-amber:hover { border-bottom-color: #ffe9c7 !important; }
.live-tile.theme-slate:hover,
.live-tile.theme-gray:hover { border-bottom-color: #dbe3e7 !important; }
.tile-party.remodel:hover { border-bottom-color: #ffb3be !important; }
.dock-news:hover { border-bottom-color: #ded8ff !important; }
.dock-mart:hover { border-bottom-color: #9bfadb !important; }
.dock-config:hover { border-bottom-color: #ffe1e0 !important; }

/* 悬浮时水印动画 */
.box-tactical:hover .t-watermark,
.box-tactical.small-h:hover .t-watermark {
    transform: rotate(0deg) scale(1.1);
    opacity: 0.1;
}

/* PARTY卡片悬浮特效 */
.tile-party.remodel:hover .tp-giant-watermark {
    opacity: 0.08;
    transform: rotate(45deg) scale(1.1);
    color: #ff4757;
}

.tile-party.remodel:hover .tp-roster-container .roster-slot {
    border-color: rgba(255, 71, 87, 0.3);
    background: rgba(255, 255, 255, 0.8);
}

.tile-party.remodel:hover .curr-val {
    color: #ff4757;
}

/* 点击反馈 */
.live-tile.box-tactical:active,
.tile-party.remodel:active,
.box-tactical.small-h:active,
.box-tactical.dock-mode:active {
    transform: translateY(-1px) scale(0.98);
    box-shadow: 0 4px 10px -4px rgba(0, 0, 0, 0.1);
}

/* =========================================
   MAP 模态框 (相对于手机容器)
   ========================================= */
.map-modal {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #f8f9fa;
    z-index: 9999;
    display: none;
    flex-direction: column;
    border-radius: inherit;
    overflow: hidden;
}

.map-modal.active {
    display: flex;
}

.map-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 16px;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    border-bottom: 2px solid #0984e3;
    flex-shrink: 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.map-modal-title {
    font-family: var(--font-ui);
    font-size: 0.85rem;
    font-weight: 800;
    color: #2d3436;
    letter-spacing: 2px;
    text-transform: uppercase;
}

.map-modal-close {
    width: 28px;
    height: 28px;
    background: rgba(231, 76, 60, 0.1);
    border: 1px solid rgba(231, 76, 60, 0.3);
    border-radius: 4px;
    color: #e74c3c;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.map-modal-close:hover {
    background: rgba(231, 76, 60, 0.2);
    border-color: #e74c3c;
    transform: scale(1.05);
}

#map-iframe {
    flex: 1;
    width: 100%;
    height: 100%;
    border: none;
    min-height: 0;
}

/* =========================================
   [REMASTERED v2] TRANSIT SYSTEM
   Style: Bright Sci-Fi / Tactical Terminal
   ========================================= */

.transit-loading {
    padding: 40px 20px;
    text-align: center;
    color: #636e72;
    font-family: 'Exo 2', sans-serif;
}

/* 顶部 Tab 栏容器 */
.transit-tabs {
    display: flex;
    gap: 12px;
    padding: 0 5px 15px 5px;
    margin-bottom: 5px;
    border-bottom: 2px dashed rgba(178, 190, 195, 0.4);
}

/* 每一个 Tab 按钮 */
.transit-tab {
    flex: 1;
    position: relative;
    height: 48px;
    background: #ffffff;
    border: 1px solid #dfe6e9;
    border-radius: 6px;
    color: #b2bec3;
    font-family: 'Exo 2', sans-serif;
    font-size: 0.75rem;
    font-weight: 800;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transform: skewX(var(--s-deg));
    box-shadow: 2px 2px 0 #ebedf0;
    overflow: hidden;
}

.transit-tab > span {
    transform: skewX(var(--ns-deg));
    display: flex;
    align-items: center;
    gap: 6px;
}

.transit-tab svg {
    width: 18px;
    height: 18px;
    stroke: currentColor;
    stroke-width: 2;
    fill: none;
    transition: all 0.2s;
}

.transit-tab:hover {
    color: #636e72;
    border-color: #b2bec3;
    transform: skewX(var(--s-deg)) translateY(-2px);
    box-shadow: 4px 6px 10px rgba(0,0,0,0.05);
}

.transit-tab.active {
    background: #fff;
    border-color: transparent;
    color: var(--tab-color);
    box-shadow: 0 4px 15px -3px var(--tab-glow), inset 0 0 0 1px var(--tab-color);
    z-index: 2;
}

.transit-tab[data-tab="loop"] { --tab-color: #00b894; --tab-glow: rgba(0, 184, 148, 0.3); }
.transit-tab[data-tab="air"]  { --tab-color: #0984e3; --tab-glow: rgba(9, 132, 227, 0.3); }
.transit-tab[data-tab="sea"]  { --tab-color: #6c5ce7; --tab-glow: rgba(108, 92, 231, 0.3); }

.transit-content {
    padding: 10px 5px;
}

.transit-panel {
    animation: fadeIn 0.2s ease;
}

.transit-section {
    margin-bottom: 24px;
}

.transit-section-title {
    font-family: 'Exo 2', sans-serif;
    font-size: 0.65rem;
    font-weight: 900;
    color: #636e72;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 0 0 8px 10px;
    display: flex;
    align-items: center;
    gap: 8px;
    opacity: 0.8;
}

.section-marker {
    display: inline-block;
    width: 6px;
    height: 6px;
    background: currentColor;
    transform: skewX(-15deg);
    box-shadow: 2px 2px 0 rgba(0,0,0,0.1);
}

.transit-section-title.curr .section-marker {
    color: #f1c40f;
    background: #f1c40f;
}

.transit-section-title.othe .section-marker {
    color: #b2bec3;
    background: #b2bec3;
}

.transit-item {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #ffffff;
    padding: 12px 18px;
    margin-bottom: 12px;
    border: 1px solid #edf2f4;
    border-radius: 6px;
    box-shadow: 2px 3px 5px rgba(0,0,0,0.02);
    transform: skewX(var(--s-deg));
    transition: all 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);
    overflow: hidden;
}

.transit-item::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background: #dfe6e9;
    transition: width 0.2s, background 0.2s;
}

.transit-back-deco {
    position: absolute;
    right: -10px;
    bottom: -10px;
    width: 60px;
    height: 60px;
    opacity: 0.03;
    pointer-events: none;
    transform: rotate(15deg);
}

.transit-back-deco svg {
    width: 100%;
    height: 100%;
    stroke-width: 1;
    stroke: #2d3436;
}

.transit-item.available {
    cursor: pointer;
    border-color: #d1d8e0;
}

.transit-item.available::before {
    background: var(--acc-color, #00b894);
}

.transit-item.available:hover {
    transform: skewX(var(--s-deg)) translateX(6px) translateY(-2px);
    box-shadow: 4px 8px 15px rgba(0,0,0,0.08);
}

.transit-item.available:hover::before {
    width: 8px;
}

.transit-item.here {
    background: linear-gradient(135deg, #fefcef 0%, #fff 60%);
    border-color: #ffeaa7;
}

.transit-item.here::before {
    background: #f1c40f;
    width: 6px;
}

.transit-item.locked {
    background: #fdfdfd;
    opacity: 0.6;
    cursor: not-allowed;
}

.transit-item.locked .ti-icon {
    filter: grayscale(1);
    opacity: 0.5;
}

.ti-left {
    display: flex;
    align-items: center;
    gap: 16px;
    transform: skewX(var(--ns-deg));
    z-index: 2;
    flex: 1;
}

.ti-icon {
    width: 38px;
    height: 38px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f9fa;
    color: #b2bec3;
    padding: 8px;
    box-sizing: border-box;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.05);
}

.transit-item[data-type="loop"] .ti-icon {
    color: #00b894;
    background: rgba(0, 184, 148, 0.05);
}

.transit-item[data-type="air"] .ti-icon {
    color: #0984e3;
    background: rgba(9, 132, 227, 0.05);
}

.transit-item[data-type="sea"] .ti-icon {
    color: #6c5ce7;
    background: rgba(108, 92, 231, 0.05);
}

.ti-icon svg {
    width: 100%;
    height: 100%;
    stroke-width: 2;
}

.ti-info {
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.ti-name {
    font-family: 'Exo 2', sans-serif;
    font-size: 0.95rem;
    font-weight: 800;
    color: #2d3436;
    letter-spacing: -0.5px;
    margin-bottom: 3px;
    line-height: 1;
}

.ti-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.65rem;
    font-weight: 700;
    color: #b2bec3;
    font-family: 'Chakra Petch', monospace;
}

.ti-region {
    padding: 1px 4px;
    border-radius: 2px;
    background: #f1f2f6;
    color: #636e72;
}

.ti-right {
    transform: skewX(var(--ns-deg));
    z-index: 2;
    text-align: right;
}

.ti-status-badge {
    font-family: 'Exo 2', sans-serif;
    font-size: 0.65rem;
    font-weight: 900;
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 4px 8px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    gap: 4px;
}

.ti-here-badge {
    color: #f1c40f;
    background: rgba(241, 196, 15, 0.1);
    box-shadow: 0 0 0 1px rgba(241, 196, 15, 0.2);
}

.ti-dist-badge {
    color: #74b9ff;
}

.ti-dist-val {
    font-family: 'Chakra Petch', monospace;
    font-size: 1.1rem;
    font-weight: 700;
    color: #0984e3;
}

.ti-dist-unit {
    color: #b2bec3;
    font-size: 0.6rem;
}

.ti-lock-badge {
    color: #b2bec3;
}

.ti-lock-badge svg {
    width: 14px;
    height: 14px;
}

.transit-empty {
    padding: 40px;
    text-align: center;
    color: #bfc5c9;
    font-family: 'Exo 2', sans-serif;
    font-style: italic;
    font-weight: 600;
    font-size: 0.8rem;
    background: rgba(255,255,255,0.3);
    border-radius: 8px;
    margin-top: 10px;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}
